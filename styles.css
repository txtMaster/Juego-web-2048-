@layer reset, propertys, base, components, utilities, theme;

@import "/css//reset.css" layer(reset);
@import "/css/propertys.css" layer(propertys);
@import "/css/utilities.css" layer(utilities);
@import "/css/Game/GameRoot.css" layer(components);
@import "/css/Game/GameScene.css" layer(components);
@import "/css/Game/GameCube.css" layer(components);
@layer theme {
	:root {
		--root-hue: 1turn;
		--color-pastel-1: lch(90, 20, 40);
		--color-pastel-2: lch(85, 15, 120);
		--color-pastel-3: lch(95, 10, 200);
		--color-pastel-4: lch(92, 18, 280);
		--color-pastel-5: lch(88, 22, 340);
	}
	:root {
		--c-1: #d5c9b8;
		--bg-1: #f6f2e9;
		--c-brown-5: #e1d6c6;
		--c-brown-4: #d5c9b8;
	}
	html {
		font-size: min(10vmin, 5dvw, 4dvh);
	}

	body {
		display: grid;
		grid-template-rows: auto 1fr auto;
		padding: 1em;
		gap: 1em;
		width: 100dvw;
		height: 100dvh;
		overflow: hidden;
		--score: 0;
		--base-hue: 0;
		background-color: var(--bg-1);
		color: white;
		font-family: Verdana, Geneva, Tahoma, sans-serif;
		font-weight: 700;

		/*animation: base-hue-road 20s infinite forwards;*/
	}
	header {
		width: 100%;
	}
	main {
		overflow: hidden;
		display: flex;
		justify-content: center;
		align-items: center;
		position: relative;
		height: 100%;
	}
	.main-section {
		width: 80%;
		display: flex;
		flex-direction: column;
		height: min-content;
		gap: 1em;
	}

	game-root {
		gap: 1em;
		flex-grow: 1;
		width: 100%;
		max-width: 100%;
		color: gray;
		display: grid;
		grid-template-rows: auto minmax(0, 1fr) auto;
		overflow: hidden;
		section.head {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 0.5em;
			.score {
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 0.5rem;
				height: 3rem;
			}
			[is="score"] {
				padding: 0.2em;
				aspect-ratio: 3 / 2;
				height: 100%;
				display: grid;
				place-content: center;
				border-radius: 0.5rem;
				background-color: #f9805f;
				color: white;
				font-size: 1.5rem;
			}
			[is="max-score"] {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: space-around;
				padding: 0.2em;
				height: 100%;
				aspect-ratio: 1 / 1;
				border-radius: 0.5em;
				background-color: var(--c-brown-5);
				font-size: 0.9rem;
				&::before {
					font-size: 0.7rem;
					content: "BEST";
				}
			}
			[is="message"] {
				font-size: 1rem;
			}
		}
		section.main {
			display: flex;
			justify-content: center;
			align-items: center;
			height: 100%;
			max-height: 100%;
			overflow: hidden;
			position: relative;
			game-scene {
				width: 100%;
				height: auto;
				max-height: 100%;

				--bg-color: var(--c-brown-4);
				--bg-grid-color: var(--c-brown-5);
				--bg-grid-space-color: var(--bg-color);
				--bg-grid-x: var(--perc-x);
				--bg-grid-y: var(--perc-y);
				color: white;
				background-repeat: repeat;
				border-radius: 1em;
				border: var(--bg-color) solid 0.3em;
				game-cube {
					border-radius: 0.5em;
				}
			}
		}

		section.footer {
			display: flex;
			justify-content: center;
			button {
				flex-grow: 1;
				background-color: rgb(131, 186, 135);
				color: white;
				border-radius: 2rem;
				padding: 0.5em;
				font-size: 1em;
				transition: transform 0.05s ease-out;
				&:active {
					filter: brightness(1.1);
					transform: scale(0.95);
				}
			}
		}
		game-scene::after {
			transition: opacity,display;
			transition-duration: .2s, 0s;
			transition-delay: .2s;
			opacity: 0;
			text-align: center;
			position: absolute;
			width: 100%;
			height: 100%;
			top: 50%;
			left: 50%;
			transform: translateX(-50%) translateY(-50%);
			z-index: 1;
			display: grid;
			place-content: center;
			content: "Use the arrows or swipe the pointer to play.";
			letter-spacing: .08em;
			word-spacing: .1em;
			color: #ffffff;
			font-size: 1.3em;
			background-image: radial-gradient(
				lch(94.13% 3.95 70.4 / 0.4) 0%,
				transparent 80%
			);
			backdrop-filter: blur(3px);
			text-shadow: 0 0 20px lch(0% 0 0 / 0.8);
		}

		&[data-state="init"] {
			game-scene::after {
				opacity: 1;
			}
		}
	}
	header {
		.sound {
			appearance: none;
			display: flex;
			aspect-ratio: 1/1;
			height: 2.5rem;
			background-image: url("/media/svg/sound.svg");
			border: none;
			background-size: contain;
			background-color: transparent;
			transition: transform 0.2s;
			opacity: 0.5;
			&:hover {
				transform: scale(1.1);
			}
			&:checked {
				opacity: 1;
			}
			&:active {
				transform: scale(0.9);
			}
		}
		#audio-controls {
			display: flex;
			gap: 1em;
			&:has(input[type="checkbox"]:checked) {
				input[type="range"] {
					left: 0%;
					opacity: 1;
				}
			}
			input[type="checkbox"] {
				z-index: 3;
			}
		}
	}

	input[type="range"] {
		transition-property: left, opacity;
		transition-duration: 0.3s;
		left: -10%;
		opacity: 0;
		position: relative;
		-webkit-appearance: none;
		appearance: none;
		background: transparent;
		cursor: pointer;
		width: 20dvw;
		z-index: 2;
	}

	input[type="range"]::-webkit-slider-thumb {
		background: #ddd3d3;
	}
	input[type="range"]::-webkit-slider-runnable-track {
		background: #9d9090;
	}

	#coor-inputs {
		display: grid;
		grid-auto-flow: column;

		grid-template-columns: 1fr auto 1fr;
		grid-template-rows: 1fr;
		gap: 0.5em;
		.x {
			align-self: center;
			color: #6c6e68;
		}
		.control {
			display: flex;
			gap: 0.2em;
			input {
				appearance: none;
				pointer-events: none;
				border-radius: 0.4em;
				font-size: 2em;
				text-align: center;
				flex: 1 1 auto;
				width: 100%;
				color: #6c6e68;
				background-color: #e6f1e9;
			}
			.input-buttons {
				display: flex;
				flex-direction: column;
				justify-content: center;
				gap: 0.2em;
				button {
					color: #6c6e68;
					background-color: #bce1d6;
					border-radius: 0.4em;
					display: grid;
					place-content: center;
					font-size: 1.1em;
					aspect-ratio: 1/1;
					padding: 0.5em;
					height: max-content;
					transition-property: filter, transform;
					transition-duration: 0.1s;
					user-select: none;
					&:active {
						filter: brightness(1.05);
						transform: scale(0.8);
					}
				}
			}
		}
	}

	/*landscape*/
	@media screen and (aspect-ratio > 4 / 7) {
		html {
			font-size: 4.5vmin;
		}
		.main-section {
			width: fit-content;
			align-items: center;
		}
		game-root {
			section.main {
				max-width: 100%;
				aspect-ratio: 1/1;
			}
		}
		#coor-inputs {
			width: min-content;
			input {
				height: 100%;
				aspect-ratio: 1/1;
			}
		}
	}
	@media screen and (aspect-ratio > 2 / 3) {
		html {
			font-size: 3vmin;
		}
		game-root {
			section.main {
				aspect-ratio: 1/1;
			}
		}
	}
}
